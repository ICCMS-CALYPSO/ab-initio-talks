## 密度泛函理论基础	

### 一.多体问题求解的困难

首先，我们知道多粒子体系的体系的哈密顿量由五部分构成，分别是核的动能，电子的动能，核与电子的库伦势能，电子与电子的库伦势能，以及核与核的库伦能。
$$ H=\sum_p{\frac{-h^2}{2M_p}\nabla_p^2}+\sum_i{\frac{-h^2}{2m}\nabla_i^2}-\sum_i{\sum_p{\frac{Z_p}{r_{ip}}}}+\frac{1}{2}\sum_{i\neq{j}}{\frac{1}{r_{ij}}}+\frac{1}{2}\sum_{p\neq{q}}{\frac{Z_pZ_q}{r_{pq}}} $$
一个水分子有10个电子，3个核，库伦项就有78项，目前最复杂的解析求解也止步于氢分子，严格求解水分子都是不可能的。

### 二.HF方程与其中的近似

Born-Oppenheimer近似：最小的原子核质量都是电子的一千多倍，因而在同样的相互作用下，电子的移动速度会较原子核快很多，这一速度的差异的结果是使得电子在每一时刻仿佛运动在静止原子核构成的势场中，而原子核则感受不到电子的具体位置，而只能受到平均作用力。由此，可以实现原子核坐标与电子坐标的近似分离变量，将求解整个体系的波函数的复杂过程分解为求解电子波函数和求解原子核波函数两个相对简单得多的过程。
$$ H_e=\sum_i{\frac{-h^2}{2m}\nabla_i^2}-\sum_i{\sum_p{\frac{Z_p}{r_{ip}}}}+\frac{1}{2}\sum_{i\neq{j}}{\frac{1}{r_{ij}}}$$

Hartree近似(平均场近似)：Hartree近似就是将电子与电子之间的相互作用，看作是电子在所有电子平均场中的作用。这样，电子与电子之间的相互作用就可以分离变量，哈密顿量可以写成单粒子哈密顿量求和的形式，波函数可以写作单粒子波函数求积的形式。$$ h_{ei}=-\frac{h^2}{2m}\nabla_i^2-\sum_p{\frac{Z_p}{r_{ip}}}+\sum_{j}\bra{\psi_{j}}{\frac{1}{r_{ij}}}\ket{\psi_{j}}$$

$$ \psi=\psi_{1}\psi_{2}...\psi_{i}...\psi_{j}...\psi_{n-1}\psi_{n}$$

Hartree-Fork方程：$ \psi=\psi_{1}\psi_{2}...\psi_{i}...\psi_{j}...\psi_{n-1}\psi_{n} $这种形式的波函数不满足电子的交换对称性。Fork提出以slater行列式来代替上述形式波函数，以对电子的交换能进行修正。

### 三.HK定理

HK 定理一：与外势场相互作用的多电子系统，不考虑常数项的外势场$V_{ext}$是系统基态电子密度的唯一泛函，即泛函$V_{ext}$除常数项外是唯一确定的。 
由于多电子系统中，外势场$V_{ext}$确定了整个系统的哈密顿量$H$,而哈密顿量$H$唯一的确定了非简并系统的基态(波函数、能量和电子密度等)。结合HK定理一，我们立即得出以下推论：  
推论一：非简并基态系统中，电子密度是系统基态(波函数、能量等)的唯一泛函。  
推论二：非简并基态系统中，由于电子波函数唯一地确定基态电子密度，基态电子密度同样是外势的唯一泛函，即泛函$\rho(V_{ext})$是唯一确定的。  
推论三：结合HK定理一和推论二，非简并基态系统中，系统的基态电子密度和外势是一一映射的。  
HK 定理二：非简并基态系统中，存在总能量密度泛函$E[\rho]$,当$ \rho=\rho_{min} $时，总能量泛函为极小值。  

### 四.KS方程

Kohn与Sham基于HK定理，对于真实的多电子系统，通过引入一个参考的无相互作用的辅助系统，Kohn 和 Sham 假定该系统与真实系统具有相同的电子密度，提出了著名的 KS-DFT。
$$ E^{KS}[\rho]=T_s[{\phi_i}]+E_H[\rho]+E_{xc}[\rho]+E_{ext}[\rho] $$
Ts是辅助系统的动能，由于辅助系统粒子无相互作用系统的波函数是由单粒子轨道组成的单Slater行列式
$$T_S[{\phi}]=-\frac{1}{2}f_i\sum_{j}\bra{\phi_{j}}{\nabla^2}\ket{\phi_{j}}$$
fi为单粒子轨道的粒子占据数，phi_i被称为KS波函数。
总能量泛函中的第二项是Hartree能，代表系统的经典电子库仑相互作用。
$$E_H[\rho]=\frac{1}{2}\int\int\frac{\rho(r_1)\rho(r_2)}{r_{12}}dr_1dr_2$$
由于总能量泛函前两项不能精确描述真实系统的电子动能和电子电子相互作用能，因此，Kohn和Sham引入了第三项作为补充项。总能量泛函中的最后一项是外势项。
$$E_{ext}[\rho]=\int V_{ext}(r)\rho(r)dr$$
由于Kohn和Sham假定了无相互作用系统与真实系统具有相同的电子密度,所以
$$\rho(r)=\sum_i{f_i|\phi(i)|^2}$$

### 五.KS与HF的对比的优缺点

优点：  
1.以密度代替波函数，密度只是坐标的标量函数，在概念与计算上都简单很多。  
2.KS中考虑了交换关联能，而HF只考虑交换能，未考虑关联能。  
3.KS精确处理对总能量贡献较大的部分，使其以更小的工作量获得更大的计算精度。  

缺点：  
1.KSDFT存在自相互作用，而HF不存在。不做自相互作用修正的近似能量密度不能正确处理弱束缚电子，自相互作用误差甚至会大于键合能。

### 六.KS方程的数值求解

我们得到单粒子方程后，可以发现，每个单粒子方程都是相同的，因为具有相同的势场。所以只要求解一个单电子薛定谔方程。求解过程中，为了方便计算，一般将分子轨道向一组基函数展开。 
 
1.类氢离子波函数：径向部分过于复杂，实际中很少使用  
2.Slater函数（STO）：将原来的多项式变为单项式，球谐函数部分不变。相对类氢简化了数学处理的复杂性。但不同的STO之间不正交，且多中心积分很复杂。  
3.Gauss函数（GTO）：两个不同中心的Gauss函数的乘积可以用另一个单中心的Gauss函数表达出来，可以解决多中心计算的困难。  
4.平面波基组  

计算过程  
1.先设定一个试探密度  
2.使用试探密度求解出有效势  
3.代入KS方程求解本征值与波函数  
4.通过波函数获得新的密度  
5.循环直至获得符合要求的能量  
采用迭代渐进法得到轨道后，需要将电子填充上去，填充时需要满足能量最低原理与泡利不相容原理，以及洪特法则（并不独立，自旋方向相同的粒子会有排斥，使能量降低）。计算时，就要获得多于电子数目的轨道。  

能量获得  
体系总能量不是单粒子能量的和，因为计算电子与电子库伦能时计算了两次，且交换关联能的形式也可能导致重复计算，在计算总能时要减去这部分。  